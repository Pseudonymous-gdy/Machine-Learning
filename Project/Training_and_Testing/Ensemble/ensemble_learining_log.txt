Stacking training completed in 15.02 seconds

Evaluating all models...
============================================================

Evaluating Balanced RF...

==================================================
Balanced RF evaluation:
--------------------------------------------------
accuracy: 0.7726300784034212
Weighted F1 score: 0.7730312378853883
Macro average F1 score: 0.7470704885523707
Class 0 F1 score: 0.6667
Class 1 F1 score: 0.8275

Classification report:
              precision    recall  f1-score   support

           0      0.662     0.672     0.667       475
           1      0.831     0.824     0.827       928

    accuracy                          0.773      1403
   macro avg      0.746     0.748     0.747      1403
weighted avg      0.773     0.773     0.773      1403


Evaluating RUSBoost...

==================================================
RUSBoost evaluation:
--------------------------------------------------
accuracy: 0.7890235210263721
Weighted F1 score: 0.7921284325392736
Macro average F1 score: 0.7720352194629252
Class 0 F1 score: 0.7098
Class 1 F1 score: 0.8343

Classification report:
              precision    recall  f1-score   support

           0      0.664     0.762     0.710       475
           1      0.868     0.803     0.834       928

    accuracy                          0.789      1403
   macro avg      0.766     0.782     0.772      1403
weighted avg      0.799     0.789     0.792      1403


Evaluating Optimized XGBoost...

==================================================
Optimized XGBoost evaluation:
--------------------------------------------------
accuracy: 0.7754811119030649
Weighted F1 score: 0.7801367540554315
Macro average F1 score: 0.7614729850729351
Class 0 F1 score: 0.7037
Class 1 F1 score: 0.8193

Classification report:
              precision    recall  f1-score   support

           0      0.636     0.787     0.704       475
           1      0.876     0.769     0.819       928

    accuracy                          0.775      1403
   macro avg      0.756     0.778     0.761      1403
weighted avg      0.795     0.775     0.780      1403


Evaluating Bagging...

==================================================
Bagging evaluation:
--------------------------------------------------
accuracy: 0.7840342124019958
Weighted F1 score: 0.7872481889731241
Macro average F1 score: 0.7667421131038116
Class 0 F1 score: 0.7032
Class 1 F1 score: 0.8303

Classification report:
              precision    recall  f1-score   support

           0      0.658     0.756     0.703       475
           1      0.865     0.798     0.830       928

    accuracy                          0.784      1403
   macro avg      0.761     0.777     0.767      1403
weighted avg      0.795     0.784     0.787      1403


Evaluating Gradient Boosting...

==================================================
Gradient Boosting evaluation:
--------------------------------------------------
accuracy: 0.7847469707769066
Weighted F1 score: 0.7854920031911625
Macro average F1 score: 0.7613848829298842
Class 0 F1 score: 0.6867
Class 1 F1 score: 0.8360

Classification report:
              precision    recall  f1-score   support

           0      0.677     0.697     0.687       475
           1      0.842     0.830     0.836       928

    accuracy                          0.785      1403
   macro avg      0.760     0.763     0.761      1403
weighted avg      0.786     0.785     0.785      1403


Evaluating Stacking...

==================================================
Stacking evaluation:
--------------------------------------------------
accuracy: 0.7833214540270849
Weighted F1 score: 0.7858209899002537
Macro average F1 score: 0.7640461870051471
Class 0 F1 score: 0.6966
Class 1 F1 score: 0.8315

Classification report:
              precision    recall  f1-score   support

           0      0.662     0.735     0.697       475
           1      0.856     0.808     0.831       928

    accuracy                          0.783      1403
   macro avg      0.759     0.771     0.764      1403
weighted avg      0.791     0.783     0.786      1403


Model Comparison:
============================================================
                   accuracy  f1_weighted  f1_macro  train_time  eval_time  f1_class_0  f1_class_1
RUSBoost           0.789024     0.792128  0.772035   12.793716   2.011163    0.709804    0.834267
Bagging            0.784034     0.787248  0.766742    0.694339   2.168655    0.703232    0.830252
Stacking           0.783321     0.785821  0.764046   15.017659   1.523253    0.696607    0.831486
Gradient Boosting  0.784747     0.785492  0.761385    4.454976   0.852247    0.686722    0.836048
Optimized XGBoost  0.775481     0.780137  0.761473   56.426075   0.805760    0.703669    0.819277
Balanced RF        0.772630     0.773031  0.747070    0.584845   1.196242    0.666667    0.827474

Evaluating Weighted Ensemble Fusion...

Fused Model Evaluation:
==================================================
accuracy: 0.7833214540270849
Weighted F1 score: 0.7858209899002537
Macro average F1 score: 0.7640461870051471
Class 0 F1 score: 0.6966
Class 1 F1 score: 0.8315

Classification report:
              precision    recall  f1-score   support

           0      0.662     0.735     0.697       475
           1      0.856     0.808     0.831       928

    accuracy                          0.783      1403
   macro avg      0.759     0.771     0.764      1403
weighted avg      0.791     0.783     0.786      1403


Updated Model Comparison with Fusion:
============================================================
                   accuracy f1_weighted  f1_macro train_time eval_time f1_class_0 f1
RUSBoost           0.789024    0.792128  0.772035  12.793716  2.011163   0.709804   0.834267
Bagging            0.784034    0.787248  0.766742   0.694339  2.168655   0.703232   0.830252
Stacking           0.783321    0.785821  0.764046  15.017659  1.523253   0.696607   0.831486
Weighted Fusion    0.783321    0.785821  0.764046        N/A       N/A   0.696607   0.831486
Gradient Boosting  0.784747    0.785492  0.761385   4.454976  0.852247   0.686722   0.836048
Optimized XGBoost  0.775481    0.780137  0.761473  56.426075   0.80576   0.703669   0.819277
Balanced RF         0.77263    0.773031   0.74707   0.584845  1.196242   0.666667   0.827474

Best model identified: RUSBoost with weighted F1: 0.7921

Analyzing feature impact using SHAP...
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [10:41<00:00,  6.41s/it]
❌ SHAP analysis failed: The shape of the shap_values matrix does not match the shape of the provided data matrix.