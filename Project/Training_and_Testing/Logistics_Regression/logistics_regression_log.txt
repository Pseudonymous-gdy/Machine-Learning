Dataset read successfully! Length of dataset: 7012

Target variable 'death' distribution:
death
1    0.661152
0    0.338848
Name: proportion, dtype: float64

=== 模型训练 ===

Training set: (5609, 67), Test set: (1403, 67)
Train class distribution: [1901 3708]
Test class distribution: [475 928]

Starting grid search...
Fitting 5 folds for each of 96 candidates, totalling 480 fits
Hyperparameter search completed!

=== Best Model ===
Best params: {'clf__C': 1.0, 'clf__class_weight': {0: 1.4752761704366124, 1: 0.7563376483279396}, 'clf__penalty': 'l2', 'clf__solver': 'saga'}
Best CV F1: 0.7672

=== Train Performance ===
Train Accuracy: 0.7818
Train AUC: 0.8784

Classification Report:
              precision    recall  f1-score   support

           0       0.63      0.84      0.72      1901
           1       0.90      0.75      0.82      3708

    accuracy                           0.78      5609
   macro avg       0.77      0.80      0.77      5609
weighted avg       0.81      0.78      0.79      5609


=== Test Performance ===
Accuracy: 0.7669
AUC: 0.8655

Classification Report:
              precision    recall  f1-score   support

           0       0.62      0.83      0.71       475
           1       0.89      0.73      0.81       928

    accuracy                           0.77      1403
   macro avg       0.75      0.78      0.76      1403
weighted avg       0.80      0.77      0.77      1403

c:\Users\moliai\OneDrive - HKUST (Guangzhou)\Study\dsaa2011\project\Machine-Learning\Project\Training_and_Testing\Logistics_Regression\logistic_reg_model.py:375: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax1.set_xticklabels(ax1.get_xticklabels(), rotation=45)

Model saved as 'best_logistic_model.pkl'
Feature importance saved as 'feature_importance.csv'
All visualizations saved in 'model_visualizations' directory